trigger:
  - none
schedules:
 - cron: "0 * * * *"
   displayName: "Every hour"
   branches:
     include:
     - main
   always: true

pool:
  vmImage: 'ubuntu-latest'

jobs:
- job: Build
  displayName: 'Build and Run Python Script'
  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.x'
      addToPath: true
  - script: |
      pip install time
      pip install schedule
      pip install unidecode
      pip install azure-storage-blob
      pip install requests
      pip freeze > requirements.txt
      python -m pip install -r requirements.txt
      python Growint_BI/Scripts_python_automatizacion/Marcas.py
    displayName: 'Run Python Script'
    continueOnError: true
  - task: SendGridEmail@2
    inputs:
      SendGridApiKey: '$(grow)'
      FromAddress: 'info@dataglobalservice.es'
      ToAddresses: 'gustavo.anton@dataglobalservice.es'
      Subject: 'Fallo en la pipeline'
      emailBodyFormat: 'InLine'
      EmailBody: 'Por favor, revisa la ejecuci√≥n de la pipeline, ha surgido un error en la misma'