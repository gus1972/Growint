trigger:
  - none
schedules:
 - cron: "0 * * * *"
   displayName: "Every hour"
   branches:
     include:
     - main
   always: true

pool:
  vmImage: 'ubuntu-latest'

jobs:
- job: Build
  displayName: 'Build and Run Python Script'
  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.x'
      addToPath: true
  - script: |
      pip install time
      pip install schedule
      pip install unidecode
      pip install azure-storage-blob
      pip install requests
      pip freeze > requirements.txt
      python -m pip install -r requirements.txt
      python Growint_BI/Scripts_python_automatizacion/Marcas.py
    displayName: 'Run Python Script'

  - task: SendGridEmail@2
    inputs:
      SendGridApiKey: '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'
      FromAddress: 'info@dataglobalservice.es'
      ToAddresses: 'gustavo.anton@globaldataservice.es'
      Subject: 'Fallo ejecución pipeline'
      emailBodyFormat: 'InLine'
      EmailBody: 'La ejecución de la pipeline, gus1972.Growint(1) ha fallado, revise errores, por favor.'